<!DOCTYPE html>
<html lang="zh" xmlns:th="http://www.thymeleaf.org">
	<head>
		<th:block th:include="include :: header('新增代理商')" />
		<th:block th:include="include :: jquery-steps-css" />
		<th:block th:include="include :: jasny-bootstrap-css" />
	</head>
<style type="text/css">
.add {
  border: 1px solid;
  width: 100px;
  height: 100px;
  color: #ccc;
  transition: color .25s;
  position: relative;
}

.add::before{
  content: '';
  position: absolute;
  left: 50%;
  top: 50%;
  width: 80px;
  margin-left: -40px;
  margin-top: -5px;
  border-top: 10px solid;
}
.add::after {
  content: '';
  position: absolute;
  left: 50%;
  top: 50%;
  height: 80px;
  margin-left: -5px;
  margin-top: -40px;
  border-left: 10px solid;
}

.add:hover {
  color: blue;
}
</style>
	<body class="gray-bg">
		<div class="wrapper wrapper-content animated fadeInRight">
			<div class="row">
				<div class="col-sm-12">
					<div class="ibox">
						<div class="ibox-content">
							<form id="form" action="" class="wizard-big">
								<h1>商户基本信息</h1>
								<fieldset>
									<div class="row">
										<div class="col-sm-6">
											<div class="form-group">
												<label>商户名称 *</label>
												<input id="merchantName" name="merchantName"type="text" class="form-control required">
											</div>
											<div class="form-group">
												<label>经营地址*</label>
												<input id="address" name="address" type="text"class="form-control required">
											</div>
											
										</div>
										<div class="col-sm-6">
										    <div class="form-group">
											    <label>经营类目 *</label>
												<select id="businessCategory" name="businessCategory"class="form-control m-b">
													<option value="1">水果</option>
													<option value="0">蔬菜</option>
												</select>
											</div>
		                                    <div class="form-group">
												<label>客服电话 *</label>
												<input id="mobile" name="mobile" type="text"class="form-control required">
											</div>
		                                 </div>
									</div>
								</fieldset>
								<h1>结算信息</h1>
								<fieldset>
									<div class="row">
										<div class="col-sm-6">
											<div class="form-group">
												<label>联系人 *</label>
												<input id="contacts" name="contacts" type="text"class="form-control required">
											</div>
											<div class="form-group">
												<label>手机号码 *</label>
												<input id="phone" name="phone" type="text"class="form-control required">
											</div>
											<div class="form-group">
												<label>邮箱 *</label>
												<input id="email" name="email" type="text"class="form-control required">
											</div>
										</div>
										<div class="col-sm-6">
											<div class="form-group">
												<label>收款银行 *</label>
												<input id="receivingBank" name="receivingBank" type="text"class="form-control required">
											</div>
											<div class="form-group">
												<label>持卡人 *</label>
												<input id="cardholder" name="cardholder" type="text"class="form-control required">
											</div>
											<div class="form-group">
												<label>银行账号 *</label>
												<input id="cardNumber" name="cardNumber" type="text"class="form-control required">
											</div>
										</div>
									</div>
								</fieldset>

								<h1>证件信息</h1>
								<fieldset>
									<div class="row">
										<div class="col-sm-3">
											<div class="form-group">
												<div class="fileinput fileinput-new" data-provides="fileinput">
												<label>营业执照 *</label>
													<div class="fileinput-preview thumbnail add" data-trigger="fileinput" ></div>
													<div style="display:none;">
														<span class="btn btn-white btn-file">
															<input id="businessLicenseImage" name="businessLicenseImage" type="file">
														</span>
													</div>
												</div>
											</div>
										</div>
										<div class="col-sm-3">
											<div class="form-group">
											<label>组织机构代码证 *</label>
												<div class="fileinput fileinput-new" data-provides="fileinput">
													<div class="fileinput-preview thumbnail add" data-trigger="fileinput"></div>
													<div style="display:none;">
														<span class="btn btn-white btn-file">
															<input id="organizationImage" name="organizationImage" type="file">
														</span>
													</div>
												</div>
											</div>
										</div>
										<div class="col-sm-3">
											<div class="form-group">
											<label>身份证正面 *</label>
												<div class="fileinput fileinput-new" data-provides="fileinput">
													<div class="fileinput-preview thumbnail add" data-trigger="fileinput" ></div>
													<div style="display:none;">
														<span class="btn btn-white btn-file">
															<input id="idcardPositiveImage" name="idcardPositiveImage" type="file">
														</span>
													</div>
												</div>
											</div>
										</div>
										<div class="col-sm-3">
											<div class="form-group">
											<label>身份证反面 *</label>
												<div class="fileinput fileinput-new" data-provides="fileinput">
													<div class="fileinput-preview thumbnail add" data-trigger="fileinput" ></div>
													<div style="display:none;">
														<span class="btn btn-white btn-file">
															<input id="idcardOthersideImage" name="idcardOthersideImage" type="file">
														</span>
													</div>
												</div>
											</div>
										</div>
									</div>
								</fieldset>
							</form>
						</div>
					</div>
				</div>

			</div>
		</div>
		<th:block th:include="include :: footer" />
		<th:block th:include="include :: jquery-steps-js" />
		<th:block th:include="include :: jasny-bootstrap-js" />
		<script>
		
		    var prefix = ctx + "system/merchant";
		    
			$(document).ready(function () {
			$("#wizard").steps();
			$("#form").steps({
			bodyTag: "fieldset", onStepChanging: function (event, currentIndex, newIndex)
			{
			if (currentIndex > newIndex) {
			return true
			}
			if (newIndex === 3 && Number($("#age").val()) < 18) {
			return false
			}
			var form = $(this);
			if (currentIndex < newIndex) {
			$(".body:eq(" + newIndex + ") label.error", form).remove();
			$(".body:eq(" + newIndex + ") .error", form).removeClass("error")
			}
			form.validate().settings.ignore = ":disabled,:hidden";
			return form.valid()
			}, onStepChanged: function (event, currentIndex, priorIndex) {
			if (currentIndex === 2 && Number($("#age").val()) >= 18) {
			$(this).steps("next")
			}
			if (currentIndex === 2 && priorIndex === 3) {
			$(this).steps("previous")
			}
			}, onFinishing: function (event, currentIndex) {
			var form = $(this);
			form.validate().settings.ignore = ":disabled";
			return form.valid()
			}, onFinished: function (event, currentIndex) {
			
			var formData = new FormData();
			if ($('#businessLicenseImage')[0].files[0] == null) {
			$.modal.alertWarning("请先选择文件路径");
			return false;
			}
			formData.append('files', $('#businessLicenseImage')[0].files[0]);
			formData.append('files', $('#organizationImage')[0].files[0]);
			formData.append('files', $('#idcardPositiveImage')[0].files[0]);
			formData.append('files', $('#idcardOthersideImage')[0].files[0]);
			formData.append('merchantName', $("#merchantName").val());
			formData.append('address', $("#address").val());
			formData.append('businessCategory', $("#businessCategory").val());
			formData.append('mobile', $("#mobile").val());
			formData.append('contacts', $("#contacts").val());
			formData.append('phone', $("#phone").val());
			formData.append('email', $("#email").val());
			formData.append('receivingBank', $("#receivingBank").val());
			formData.append('cardholder', $("#cardholder").val());
			formData.append('cardNumber', $("#cardNumber").val());
			$.ajax({
			url: prefix + "/add",
			type: 'post',
			cache: false,
			data: formData,
			processData: false,
			contentType: false,
			dataType: "json",
			success: function(result) {
			$.operate.successCallback(result);
			}
			});
			}
			}).validate({
			errorPlacement: function (error, element) {
			element.before(error)
			}, rules: {confirm: {equalTo: "#password"}}
			})
			});
		</script>
	</body>
</html>